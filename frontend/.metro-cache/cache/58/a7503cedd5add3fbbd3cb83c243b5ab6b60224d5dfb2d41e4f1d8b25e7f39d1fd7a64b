{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":13,"column":29,"index":254},"end":{"line":13,"column":84,"index":309}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/objectSpread2","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":16,"column":44,"index":416},"end":{"line":16,"column":91,"index":463}}],"key":"F+ExrfS9dcoZxXJOBwTmx09hji8=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/createForOfIteratorHelperLoose","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":17,"column":62,"index":528},"end":{"line":17,"column":126,"index":592}}],"key":"D8hazSpj47mvz7vrnefek88staE=","exportNames":["*"],"imports":1}},{"name":"fbjs/lib/invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":18,"column":40,"index":635},"end":{"line":18,"column":69,"index":664}}],"key":"ePiUN85REKH0vTLGPPDgdWgjFww=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,e,d){'use strict';var t=r(d[0]).default;e.__esModule=!0,e.default=void 0;var n=t(r(d[1])),s=t(r(d[2])),l=t(r(d[3]));function o(t,n,s,l,o,c){if(u(s,l,o))return!0;var v=h(s,l,o);return 100*(t?v/o:v/c)>=n}function h(t,n,s){var l=Math.min(n,s)-Math.max(t,0);return Math.max(0,l)}function u(t,n,s){return t>=0&&n<=s&&n>t}e.default=class{constructor(t){void 0===t&&(t={viewAreaCoveragePercentThreshold:0}),this._hasInteracted=!1,this._timers=new Set,this._viewableIndices=[],this._viewableItems=new Map,this._config=t}dispose(){this._timers.forEach(clearTimeout)}computeViewableItems(t,n,s,h,u){var c=t.getItemCount(t.data),v=this._config,f=v.itemVisiblePercentThreshold,_=v.viewAreaCoveragePercentThreshold,w=null!=_,I=w?_:f;(0,l.default)(null!=I&&null!=f!=(null!=_),'Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold');var b=[];if(0===c)return b;var p=-1,y=u||{first:0,last:c-1},T=y.first,V=y.last;if(V>=c)return console.warn('Invalid render range computing viewability '+JSON.stringify({renderRange:u,itemCount:c})),[];for(var C=T;C<=V;C++){var M=h(C,t);if(M){var P=M.offset-n,S=P+M.length;if(P<s&&S>0)p=C,o(w,I,P,S,s,M.length)&&b.push(C);else if(p>=0)break}}return b}onUpdate(t,n,s,l,o,h,u){var c=t.getItemCount(t.data);if((!this._config.waitForInteraction||this._hasInteracted)&&0!==c&&l(0,t)){var v=[];if(c&&(v=this.computeViewableItems(t,n,s,l,u)),this._viewableIndices.length!==v.length||!this._viewableIndices.every((t,n)=>t===v[n]))if(this._viewableIndices=v,this._config.minimumViewTime){var f=setTimeout(()=>{this._timers.delete(f),this._onUpdateSync(t,v,h,o)},this._config.minimumViewTime);this._timers.add(f)}else this._onUpdateSync(t,v,h,o)}}resetViewableIndices(){this._viewableIndices=[]}recordInteraction(){this._hasInteracted=!0}_onUpdateSync(t,l,o,h){l=l.filter(t=>this._viewableIndices.includes(t));for(var u,c=this._viewableItems,v=new Map(l.map(n=>{var s=h(n,!0,t);return[s.key,s]})),f=[],_=(0,s.default)(v);!(u=_()).done;){var w=u.value,I=w[0],b=w[1];c.has(I)||f.push(b)}for(var p,y=(0,s.default)(c);!(p=y()).done;){var T=p.value,V=T[0],C=T[1];v.has(V)||f.push((0,n.default)((0,n.default)({},C),{},{isViewable:!1}))}f.length>0&&(this._viewableItems=v,o({viewableItems:Array.from(v.values()),changed:f,viewabilityConfig:this._config}))}};m.exports=e.default});","lineCount":1,"map":[[1,28,11,0],[1,41,13,0],[1,45,13,4,"_interopRequireDefault"],[1,47,13,29,"require"],[1,49,13,36,"d"],[1,51,13,36],[1,55,13,85,"default"],[1,63,14,0,"exports"],[1,65,14,8,"__esModule"],[1,77,14,21],[1,79,15,0,"exports"],[1,81,15,8,"default"],[1,94,15,15,"undefined"],[1,96,16,0],[1,100,16,4,"_objectSpread2"],[1,102,16,21,"_interopRequireDefault"],[1,104,16,44,"require"],[1,106,16,51,"d"],[1,108,16,51],[1,113,17,4,"_createForOfIteratorHelperLoose2"],[1,115,17,39,"_interopRequireDefault"],[1,117,17,62,"require"],[1,119,17,69,"d"],[1,121,17,69],[1,126,18,4,"_invariant"],[1,128,18,17,"_interopRequireDefault"],[1,130,18,40,"require"],[1,132,18,47,"d"],[1,134,18,47],[1,139,193,0],[1,148,193,9,"_isViewable"],[1,150,193,21,"viewAreaMode"],[1,152,193,35,"viewablePercentThreshold"],[1,154,193,61,"top"],[1,156,193,66,"bottom"],[1,158,193,74,"viewportHeight"],[1,160,193,90,"itemLength"],[1,163,194,2],[1,166,194,6,"_isEntirelyVisible"],[1,168,194,25,"top"],[1,170,194,30,"bottom"],[1,172,194,38,"viewportHeight"],[1,175,195,4],[1,182,195,11],[1,184,197,4],[1,188,197,8,"pixels"],[1,190,197,17,"_getPixelsVisible"],[1,192,197,35,"top"],[1,194,197,40,"bottom"],[1,196,197,48,"viewportHeight"],[1,199,199,4],[1,206,198,18],[1,211,198,25,"viewAreaMode"],[1,213,198,40,"pixels"],[1,215,198,49,"viewportHeight"],[1,217,198,66,"pixels"],[1,219,198,75,"itemLength"],[1,223,199,22,"viewablePercentThreshold"],[1,224,201,0],[1,225,202,0],[1,234,202,9,"_getPixelsVisible"],[1,236,202,27,"top"],[1,238,202,32,"bottom"],[1,240,202,40,"viewportHeight"],[1,243,203,2],[1,247,203,6,"visibleHeight"],[1,249,203,22,"Math"],[1,254,203,27,"min"],[1,258,203,31,"bottom"],[1,260,203,39,"viewportHeight"],[1,263,203,57,"Math"],[1,268,203,62,"max"],[1,272,203,66,"top"],[1,274,203,71],[1,277,204,2],[1,284,204,9,"Math"],[1,289,204,14,"max"],[1,293,204,18],[1,295,204,21,"visibleHeight"],[1,297,205,0],[1,298,206,0],[1,307,206,9,"_isEntirelyVisible"],[1,309,206,28,"top"],[1,311,206,33,"bottom"],[1,313,206,41,"viewportHeight"],[1,316,207,2],[1,323,207,9,"top"],[1,326,207,16],[1,329,207,21,"bottom"],[1,332,207,31,"viewportHeight"],[1,335,207,49,"bottom"],[1,337,207,58,"top"],[1,338,208,0],[1,339,209,15,"exports"],[1,341,209,23,"default"],[1,349,31,0],[1,355,32,2,"constructor"],[1,367,32,14,"config"],[1,375,33,14,"undefined"],[1,379,33,8,"config"],[1,383,34,6,"config"],[1,385,34,15],[1,386,35,8,"viewAreaCoveragePercentThreshold"],[1,419,35,42],[1,423,38,4,"this"],[1,428,38,9,"_hasInteracted"],[1,444,38,26],[1,446,39,4,"this"],[1,451,39,9,"_timers"],[1,459,39,19],[1,463,39,23,"Set"],[1,467,40,4,"this"],[1,472,40,9,"_viewableIndices"],[1,489,40,28],[1,492,41,4,"this"],[1,497,41,9,"_viewableItems"],[1,512,41,26],[1,516,41,30,"Map"],[1,520,42,4,"this"],[1,525,42,9,"_config"],[1,533,42,19,"config"],[1,534,43,2],[1,535,48,2,"dispose"],[1,545,52,4,"this"],[1,550,52,9,"_timers"],[1,558,52,17,"forEach"],[1,566,52,25,"clearTimeout"],[1,579,53,2],[1,580,58,2,"computeViewableItems"],[1,601,58,23,"props"],[1,603,58,30,"scrollOffset"],[1,605,58,44,"viewportHeight"],[1,607,58,60,"getFrameMetrics"],[1,609,60,2,"renderRange"],[1,612,61,4],[1,616,61,8,"itemCount"],[1,618,61,20,"props"],[1,620,61,26,"getItemCount"],[1,633,61,39,"props"],[1,635,61,45,"data"],[1,641,62,8,"_this$_config"],[1,643,62,24,"this"],[1,648,62,29,"_config"],[1,656,63,6,"itemVisiblePercentThreshold"],[1,658,63,36,"_this$_config"],[1,660,63,50,"itemVisiblePercentThreshold"],[1,688,64,6,"viewAreaCoveragePercentThreshold"],[1,690,64,41,"_this$_config"],[1,692,64,55,"viewAreaCoveragePercentThreshold"],[1,725,65,8,"viewAreaMode"],[1,727,65,59],[1,733,65,23,"viewAreaCoveragePercentThreshold"],[1,735,66,8,"viewablePercentThreshold"],[1,737,66,35,"viewAreaMode"],[1,739,66,50,"viewAreaCoveragePercentThreshold"],[1,741,66,85,"itemVisiblePercentThreshold"],[1,744,67,4],[1,746,67,8,"_invariant"],[1,748,67,19,"default"],[1,757,67,56],[1,763,67,28,"viewablePercentThreshold"],[1,766,67,95],[1,772,67,64,"itemVisiblePercentThreshold"],[1,776,67,141],[1,782,67,105,"viewAreaCoveragePercentThreshold"],[1,785,67,148],[1,876,68,4],[1,880,68,8,"viewableIndices"],[1,882,68,26],[1,885,69,4],[1,888,69,22],[1,892,69,8,"itemCount"],[1,894,70,6],[1,901,70,13,"viewableIndices"],[1,903,72,4],[1,907,72,8,"firstVisible"],[1,910,72,20],[1,912,73,8,"_ref"],[1,914,73,15,"renderRange"],[1,917,73,30],[1,918,74,8,"first"],[1,924,74,15],[1,926,75,8,"last"],[1,931,75,14,"itemCount"],[1,933,75,26],[1,936,77,6,"first"],[1,938,77,14,"_ref"],[1,940,77,19,"first"],[1,946,78,6,"last"],[1,948,78,13,"_ref"],[1,950,78,18,"last"],[1,955,79,4],[1,958,79,8,"last"],[1,961,79,16,"itemCount"],[1,963,84,6],[1,970,80,6,"console"],[1,978,80,14,"warn"],[1,983,80,19],[1,1029,80,67,"JSON"],[1,1034,80,72,"stringify"],[1,1044,80,82],[1,1045,81,8,"renderRange"],[1,1059,82,8,"itemCount"],[1,1074,84,13],[1,1077,86,4],[1,1081,86,9],[1,1085,86,13,"idx"],[1,1087,86,19,"first"],[1,1089,86,26,"idx"],[1,1092,86,33,"last"],[1,1094,86,39,"idx"],[1,1098,86,46],[1,1099,87,6],[1,1103,87,10,"metrics"],[1,1105,87,20,"getFrameMetrics"],[1,1107,87,36,"idx"],[1,1109,87,41,"props"],[1,1112,88,6],[1,1115,88,11,"metrics"],[1,1117,88,6],[1,1118,91,6],[1,1122,91,10,"top"],[1,1124,91,16,"metrics"],[1,1126,91,24,"offset"],[1,1133,91,33,"scrollOffset"],[1,1135,92,10,"bottom"],[1,1137,92,19,"top"],[1,1139,92,25,"metrics"],[1,1141,92,33,"length"],[1,1148,93,6],[1,1151,93,10,"top"],[1,1153,93,16,"viewportHeight"],[1,1156,93,34,"bottom"],[1,1158,93,43],[1,1160,94,8,"firstVisible"],[1,1162,94,23,"idx"],[1,1164,95,12,"_isViewable"],[1,1166,95,24,"viewAreaMode"],[1,1168,95,38,"viewablePercentThreshold"],[1,1170,95,64,"top"],[1,1172,95,69,"bottom"],[1,1174,95,77,"viewportHeight"],[1,1176,95,93,"metrics"],[1,1178,95,101,"length"],[1,1187,96,10,"viewableIndices"],[1,1189,96,26,"push"],[1,1194,96,31,"idx"],[1,1202,98,13],[1,1205,98,17,"firstVisible"],[1,1208,98,33],[1,1210,99,8],[1,1215,90,6],[1,1216,101,4],[1,1217,102,4],[1,1224,102,11,"viewableIndices"],[1,1225,103,2],[1,1226,109,2,"onUpdate"],[1,1235,109,11,"props"],[1,1237,109,18,"scrollOffset"],[1,1239,109,32,"viewportHeight"],[1,1241,109,48,"getFrameMetrics"],[1,1243,109,65,"createViewToken"],[1,1245,109,82,"onViewableItemsChanged"],[1,1247,111,2,"renderRange"],[1,1250,112,4],[1,1254,112,8,"itemCount"],[1,1256,112,20,"props"],[1,1258,112,26,"getItemCount"],[1,1271,112,39,"props"],[1,1273,112,45,"data"],[1,1279,113,4],[1,1284,113,8,"this"],[1,1289,113,13,"_config"],[1,1297,113,21,"waitForInteraction"],[1,1317,113,44,"this"],[1,1322,113,49,"_hasInteracted"],[1,1339,113,81],[1,1343,113,67,"itemCount"],[1,1346,113,87,"getFrameMetrics"],[1,1348,113,103],[1,1350,113,106,"props"],[1,1353,113,4],[1,1354,116,4],[1,1358,116,8,"viewableIndices"],[1,1360,116,26],[1,1363,120,4],[1,1366,117,8,"itemCount"],[1,1370,118,6,"viewableIndices"],[1,1372,118,24,"this"],[1,1377,118,29,"computeViewableItems"],[1,1398,118,50,"props"],[1,1400,118,57,"scrollOffset"],[1,1402,118,71,"viewportHeight"],[1,1404,118,87,"getFrameMetrics"],[1,1406,118,104,"renderRange"],[1,1410,120,8,"this"],[1,1415,120,13,"_viewableIndices"],[1,1432,120,30,"length"],[1,1441,120,41,"viewableIndices"],[1,1443,120,57,"length"],[1,1452,120,67,"this"],[1,1457,120,72,"_viewableIndices"],[1,1474,120,89,"every"],[1,1480,120,95],[1,1481,120,96,"v"],[1,1483,120,99,"ii"],[1,1487,120,106,"v"],[1,1491,120,112,"viewableIndices"],[1,1493,120,128,"ii"],[1,1497,126,4],[1,1500,125,4,"this"],[1,1505,125,9,"_viewableIndices"],[1,1522,125,28,"viewableIndices"],[1,1524,126,8,"this"],[1,1529,126,13,"_config"],[1,1537,126,21,"minimumViewTime"],[1,1553,126,38],[1,1554,127,6],[1,1558,127,10,"handle"],[1,1560,127,19,"setTimeout"],[1,1571,127,30],[1,1576,131,8,"this"],[1,1581,131,13,"_timers"],[1,1589,131,21,"delete"],[1,1596,131,28,"handle"],[1,1599,132,8,"this"],[1,1604,132,13,"_onUpdateSync"],[1,1618,132,27,"props"],[1,1620,132,34,"viewableIndices"],[1,1622,132,51,"onViewableItemsChanged"],[1,1624,132,75,"createViewToken"],[1,1628,133,9,"this"],[1,1633,133,14,"_config"],[1,1641,133,22,"minimumViewTime"],[1,1658,137,6,"this"],[1,1663,137,11,"_timers"],[1,1671,137,19,"add"],[1,1675,137,23,"handle"],[1,1677,138,4],[1,1683,139,6,"this"],[1,1688,139,11,"_onUpdateSync"],[1,1702,139,25,"props"],[1,1704,139,32,"viewableIndices"],[1,1706,139,49,"onViewableItemsChanged"],[1,1708,139,73,"createViewToken"],[1,1710,115,4],[1,1711,141,2],[1,1712,146,2,"resetViewableIndices"],[1,1735,147,4,"this"],[1,1740,147,9,"_viewableIndices"],[1,1757,147,28],[1,1759,148,2],[1,1760,153,2,"recordInteraction"],[1,1780,154,4,"this"],[1,1785,154,9,"_hasInteracted"],[1,1801,154,26],[1,1802,155,2],[1,1803,156,2,"_onUpdateSync"],[1,1817,156,16,"props"],[1,1819,156,23,"viewableIndicesToCheck"],[1,1821,156,47,"onViewableItemsChanged"],[1,1823,156,71,"createViewToken"],[1,1826,158,4,"viewableIndicesToCheck"],[1,1828,158,29,"viewableIndicesToCheck"],[1,1830,158,52,"filter"],[1,1837,158,59,"ii"],[1,1840,158,65,"this"],[1,1845,158,70,"_viewableIndices"],[1,1862,158,87,"includes"],[1,1871,158,96,"ii"],[1,1875,165,4],[1,1879,159,4],[1,1883,165,83,"_step"],[1,1885,159,8,"prevItems"],[1,1887,159,20,"this"],[1,1892,159,25,"_viewableItems"],[1,1907,160,8,"nextItems"],[1,1909,160,20],[1,1913,160,24,"Map"],[1,1917,160,28,"viewableIndicesToCheck"],[1,1919,160,51,"map"],[1,1923,160,55,"ii"],[1,1927,161,6],[1,1931,161,10,"viewable"],[1,1933,161,21,"createViewToken"],[1,1935,161,37,"ii"],[1,1938,161,41],[1,1940,161,47,"props"],[1,1943,162,6],[1,1949,162,13],[1,1950,162,14,"viewable"],[1,1952,162,23,"key"],[1,1956,162,28,"viewable"],[1,1962,164,8,"changed"],[1,1964,164,18],[1,1967,165,13,"_iterator"],[1,1970,165,25],[1,1972,165,29,"_createForOfIteratorHelperLoose2"],[1,1974,165,62,"default"],[1,1983,165,71,"nextItems"],[1,1988,165,92,"_step"],[1,1990,165,100,"_iterator"],[1,1995,165,113,"done"],[1,2001,165,120],[1,2002,166,6],[1,2006,166,10,"_step$value"],[1,2008,166,24,"_step"],[1,2010,166,30,"value"],[1,2016,167,8,"key"],[1,2018,167,14,"_step$value"],[1,2020,167,26],[1,2023,168,8,"viewable"],[1,2025,168,19,"_step$value"],[1,2027,168,31],[1,2030,169,11,"prevItems"],[1,2032,169,21,"has"],[1,2036,169,25,"key"],[1,2040,170,8,"changed"],[1,2042,170,16,"push"],[1,2047,170,21,"viewable"],[1,2049,172,4],[1,2050,173,4],[1,2054,173,9],[1,2058,173,84,"_step2"],[1,2060,173,13,"_iterator2"],[1,2063,173,26],[1,2065,173,30,"_createForOfIteratorHelperLoose2"],[1,2067,173,63,"default"],[1,2076,173,72,"prevItems"],[1,2081,173,94,"_step2"],[1,2083,173,103,"_iterator2"],[1,2088,173,117,"done"],[1,2094,173,124],[1,2095,174,6],[1,2099,174,10,"_step2$value"],[1,2101,174,25,"_step2"],[1,2103,174,32,"value"],[1,2109,175,8,"_key"],[1,2111,175,15,"_step2$value"],[1,2113,175,28],[1,2116,176,8,"_viewable"],[1,2118,176,20,"_step2$value"],[1,2120,176,33],[1,2123,177,11,"nextItems"],[1,2125,177,21,"has"],[1,2129,177,25,"_key"],[1,2133,178,8,"changed"],[1,2135,178,16,"push"],[1,2141,178,21],[1,2143,178,25,"_objectSpread2"],[1,2145,178,40,"default"],[1,2155,178,49],[1,2157,178,53,"_objectSpread2"],[1,2159,178,68,"default"],[1,2168,178,77],[1,2169,178,78],[1,2171,178,81,"_viewable"],[1,2174,178,93],[1,2175,178,94],[1,2177,178,97],[1,2178,179,10,"isViewable"],[1,2190,179,22],[1,2194,182,4],[1,2195,183,8,"changed"],[1,2197,183,16,"length"],[1,2204,183,25],[1,2208,184,6,"this"],[1,2213,184,11,"_viewableItems"],[1,2228,184,28,"nextItems"],[1,2230,185,6,"onViewableItemsChanged"],[1,2232,185,29],[1,2233,186,8,"viewableItems"],[1,2247,186,23,"Array"],[1,2253,186,29,"from"],[1,2258,186,34,"nextItems"],[1,2260,186,44,"values"],[1,2270,187,8,"changed"],[1,2280,188,8,"viewabilityConfig"],[1,2298,188,27,"this"],[1,2303,188,32,"_config"],[1,2313,191,2],[1,2316,210,0,"module"],[1,2318,210,7,"exports"],[1,2326,210,17,"exports"],[1,2328,210,25,"default"],[1,2335,210,33],[1,2338]],"functionMap":{"names":["<global>","ViewabilityHelper","ViewabilityHelper#constructor","ViewabilityHelper#dispose","ViewabilityHelper#computeViewableItems","ViewabilityHelper#onUpdate","_viewableIndices.every$argument_0","setTimeout$argument_0","ViewabilityHelper#resetViewableIndices","ViewabilityHelper#recordInteraction","ViewabilityHelper#_onUpdateSync","viewableIndicesToCheck.filter$argument_0","viewableIndicesToCheck.map$argument_0","_isViewable","_getPixelsVisible","_isEntirelyVisible"],"mappings":"AAA;AC8B;ECC;GDW;EEK;GFK;EGK;GH6C;EIM;+FCW,oCD;8BEO;OFM;GJQ;EOK;GPE;EQK;GRE;ESC;2DCE,wCD;uDEE;KFG;GT4B;CDC;AaC;CbQ;AcC;CdG;AeC;CfE"},"hasCjsExports":true},"type":"js/module"}]}